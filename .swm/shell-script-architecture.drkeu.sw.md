---
id: drkeu
name: Shell Script Architecture
file_version: 1.0.2
app_version: 0.9.6-1
file_blobs:
  bin/sonarqube: 4f12d03eb09fb01cf366db7583131b49d4c035c5
  bin/lib/_lib.sh: 0707edaa68d54e480e6504633836dcc9ccadd4ff
  bin/lib/core/sonarqube.sh: 087018ec92e1b73ab51c9628bfa710348dd2ad13
---

The Shell script is a lightweight command-line interface for interacting with [SonarQube](https://www.sonarqube.org/) _Community Edition_ and analysing your source code with SonarScanner (_CLI_) in a Docker environment.

The Localhost SonarQube codebase is under the [[sym:./././bin(90a5b0e4-f3b7-42b4-91f9-53ec6ae51569)]] directory. There are additional folders related to the shell script in additional locations, as described below.

### [[sym:././bin/bootstrap(59e4038b-7731-4d0c-8478-0cf88602d53b)]]

The `ðŸ“„ bin/bootstrap/app.sh`is located under this folder which triggers the Localhost SonarQube `console`.

### `ðŸ“„ bin/config`

The global variables are located under this folder - for example [[sym:././bin/config/app.sh(16d5a56f-0b93-4315-949f-65da2663abf3)]].

### `ðŸ“„ bin/lib`

The majority of the codebase is located under this folder. This includes CLI commands, console message outputs, and Docker CLI interactions.

### `ðŸ“„ bin/packages`

All third-party vendor packages are located under this folder. Currently, there is no package manager in place to manage third-party dependencies.

### `ðŸ“„ docker`

The `ðŸ“„ docker/docker-compose.yml`file is located under this folder which defines the SonarQube and PostgreSQL services.

### `ðŸ“„ sonarscanner-templates`

All SonarScanner configuration templates ([sonar-project.properties](http://sonar-project.properties)) are located under this folder.

## Bootstrap the App

<br/>

The entry point to the Shell Script is here. This will trigger the `main` function, which is located in `ðŸ“„ bin/bootstrap/app.sh`. There is an alias shell script for this file in the root directory of the project, called `ðŸ“„ sonarqube`
<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### ðŸ“„ bin/sonarqube
```
â¬œ 57     # SonarQube application main function.
â¬œ 58     #######################################
â¬œ 59     
ðŸŸ© 60     main "$@"
â¬œ 61     
```

<br/>

### Dependencies Manager

<br/>

Files prefixed with an underscore will source Shell files. Consider these files as Shell file importers. The `_lib.sh` will source third-party dependencies and other Shell file importers. Importers include a read-only array of dependencies within their domain e.g. the commands importer which is located in `ðŸ“„ bin/lib/commands/_commands.sh`
<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### ðŸ“„ bin/lib/_lib.sh
```shell
â¬œ 43     # Load Dependencies
â¬œ 44     #######################################
â¬œ 45     
ðŸŸ© 46     for DEPENDENCY in "${DEPENDENCIES[@]}"; do
ðŸŸ© 47       # shellcheck source=/dev/null
ðŸŸ© 48       source "${LIB_DIR}/${DEPENDENCY}/_${DEPENDENCY}.sh"
ðŸŸ© 49     done
â¬œ 50     
```

<br/>

## Trigger CLI command

<br/>

The `sonarqube::console` function will trigger the Localhost SonarQube commands by transforming the first argument from the user input and dynamically constructing the command function following the command naming convention.
<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### ðŸ“„ bin/lib/core/sonarqube.sh
```shell
â¬œ 37             command::usage
â¬œ 38             break;;
â¬œ 39           *)
ðŸŸ© 40             local sonarqube_command="command::${argument//-/_}"
ðŸŸ© 41     
ðŸŸ© 42             if [[ $( type -t "${sonarqube_command}" ) != function ]]; then
ðŸŸ© 43               console::error --margin-top --margin-bottom \
ðŸŸ© 44                 "Command $(ansi --bold --white "${argument}" ) is not supported."
ðŸŸ© 45     
ðŸŸ© 46               console::output \
ðŸŸ© 47                 "To view a list of all available commands use the following:" \
ðŸŸ© 48                 "$(ansi --bold --white "${APP_COMMAND} --help")"
ðŸŸ© 49     
ðŸŸ© 50               exit 1
ðŸŸ© 51             fi
ðŸŸ© 52     
ðŸŸ© 53             if [[ "${exclude_commands[*]}" != *"${argument}"* ]]; then
ðŸŸ© 54               message::supportUkraine
ðŸŸ© 55             fi
ðŸŸ© 56     
ðŸŸ© 57             # Execute the Localhost SonarQube command.
ðŸŸ© 58             "${sonarqube_command}" "$@"
â¬œ 59     
â¬œ 60             break;;
â¬œ 61         esac
```

<br/>

This file was generated by Swimm. [Click here to view it in the app](https://app.swimm.io/repos/Z2l0aHViJTNBJTNBbG9jYWxob3N0LXNvbmFycXViZSUzQSUzQWx1aXNhdmVpcm8=/docs/drkeu).