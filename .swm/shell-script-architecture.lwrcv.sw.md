---
id: lwrcv
name: Shell Script Architecture
file_version: 1.1.0
app_version: 1.0.6
file_blobs:
  bin/sonarqube: 4f12d03eb09fb01cf366db7583131b49d4c035c5
  bin/lib/_lib.sh: 0707edaa68d54e480e6504633836dcc9ccadd4ff
  bin/lib/core/sonarqube.sh: 087018ec92e1b73ab51c9628bfa710348dd2ad13
---

The Shell script is a lightweight command-line interface for interacting with [SonarQube](https://www.sonarqube.org/) _Community Edition_ and analysing your source code with SonarScanner (_CLI_) in a Docker environment.

The Localhost SonarQube codebase is under the `游늯 bin` directory. There are additional folders related to the shell script in additional locations, as described below.

### `游늯 bin/bootstrap/app.sh`

The `游늯 bin/bootstrap/app.sh` is located under this folder which triggers the Localhost SonarQube `console`.

### `游늯 bin/config`

The global variables are located under this folder - for example `游늯 bin/config/app.sh`.

### `游늯 bin/lib`

The majority of the codebase is located under this folder. This includes CLI commands, console message outputs, and Docker CLI interactions.

### `游늯 bin/packages`

All third-party vendor packages are located under this folder. Currently, there is no package manager in place to manage third-party dependencies.

### `游늯 docker`

The `游늯 docker/docker-compose.yml` file is located under this folder which defines the SonarQube and PostgreSQL services.

### `游늯 sonarscanner-templates`

All SonarScanner configuration templates (sonar-project.properties) are located under this folder.

<br/>

## Bootstrap the App

<br/>

The entry point to the Shell Script is here. This will trigger the `main`<swm-token data-swm-token=":bin/sonarqube:60:0:0:`main &quot;$@&quot;`"/> function, which is located in `游늯 bin/bootstrap/app.sh`. There is an alias shell script for this file in the root directory of the project, called `游늯` `游늯 sonarqube`
<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### 游늯 bin/sonarqube
```
游릴 53     #######################################
游릴 54     # Run The Application
游릴 55     #
游릴 56     # Finally, we execute the Localhost
游릴 57     # SonarQube application main function.
游릴 58     #######################################
游릴 59     
游릴 60     main "$@"
```

<br/>

<br/>

## Dependencies Manager

<br/>

Files prefixed with an underscore will source Shell files. Consider these files as Shell file importers. The `游늯 bin/lib/_lib.sh` will source third-party dependencies and other Shell file importers. Importers include a read-only array of dependencies within their domain e.g. the commands importer which is located in `游늯 bin/lib/commands/_commands.sh`
<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### 游늯 bin/lib/_lib.sh
```shell
游릴 32     readonly DEPENDENCIES=(
游릴 33       "commands"
游릴 34       "console"
游릴 35       "core"
游릴 36       "filesystem"
游릴 37       "services"
游릴 38       "support"
游릴 39       "utils"
游릴 40     )
游릴 41     
游릴 42     #######################################
游릴 43     # Load Dependencies
游릴 44     #######################################
游릴 45     
游릴 46     for DEPENDENCY in "${DEPENDENCIES[@]}"; do
游릴 47       # shellcheck source=/dev/null
游릴 48       source "${LIB_DIR}/${DEPENDENCY}/_${DEPENDENCY}.sh"
游릴 49     done
```

<br/>

<br/>

## Trigger CLI command

<br/>

The `sonarqube::console` function will trigger the Localhost SonarQube commands by transforming the first argument from the user input and dynamically constructing the command function following the command naming convention.
<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### 游늯 bin/lib/core/sonarqube.sh
```shell
游릴 30       for argument in "$@"; do
游릴 31         shift
游릴 32         case "${argument}" in
游릴 33           -v|--version)
游릴 34             command::version
游릴 35             break;;
游릴 36           -h|--help)
游릴 37             command::usage
游릴 38             break;;
游릴 39           *)
游릴 40             local sonarqube_command="command::${argument//-/_}"
游릴 41     
游릴 42             if [[ $( type -t "${sonarqube_command}" ) != function ]]; then
游릴 43               console::error --margin-top --margin-bottom \
游릴 44                 "Command $(ansi --bold --white "${argument}" ) is not supported."
游릴 45     
游릴 46               console::output \
游릴 47                 "To view a list of all available commands use the following:" \
游릴 48                 "$(ansi --bold --white "${APP_COMMAND} --help")"
游릴 49     
游릴 50               exit 1
游릴 51             fi
游릴 52     
游릴 53             if [[ "${exclude_commands[*]}" != *"${argument}"* ]]; then
游릴 54               message::supportUkraine
游릴 55             fi
游릴 56     
游릴 57             # Execute the Localhost SonarQube command.
游릴 58             "${sonarqube_command}" "$@"
游릴 59     
游릴 60             break;;
游릴 61         esac
游릴 62       done
```

<br/>

This file was generated by Swimm. [Click here to view it in the app](https://app.swimm.io/repos/Z2l0aHViJTNBJTNBbG9jYWxob3N0LXNvbmFycXViZSUzQSUzQWx1aXNhdmVpcm8=/docs/lwrcv).
